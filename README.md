TODO: currently runs asynchronously.  If possible, let's have this run synchronously.